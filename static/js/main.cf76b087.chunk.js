(this["webpackJsonpit-incubator-todolist-ts2"]=this["webpackJsonpit-incubator-todolist-ts2"]||[]).push([[0],{101:function(e,t,a){e.exports=a(120)},106:function(e,t,a){},107:function(e,t,a){},120:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),i=a.n(o);a(106),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(107);var l,s,c,u,d,f=a(164),p=a(165),m=a(166),h=a(157),b=a(122),v=a(159),g=a(168),E=a(169),k=a(167),y=a(21),I=a(34),j=a(13),w=a.n(j),C=a(25),O=a(22),x=Object(O.b)("common/todoList-and-tasks"),T=O.c.withTypes(),A=a(170).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"1cdd9f77-c60e-4af5-b194-659e4ebd5d41"}}),S=function(){return A.get("todo-lists")},L=function(e){return A.post("todo-lists",{title:e})},W=function(e){return A.delete("todo-lists/".concat(e))},F=function(e,t){return A.put("todo-lists/".concat(e),{title:t})};!function(e){e[e.succeeded=0]="succeeded",e[e.failed=1]="failed"}(l||(l={})),function(e){e.idle="idle",e.loading="loading",e.succeeded="succeeded",e.failed="failed"}(s||(s={})),function(e){e[e.New=0]="New",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Draft=3]="Draft"}(c||(c={})),function(e){e[e.Low=0]="Low",e[e.Middle=1]="Middle",e[e.Hi=2]="Hi",e[e.Urgently=3]="Urgently",e[e.Later=4]="Later"}(u||(u={})),function(e){e.all="all",e.active="active",e.completed="completed"}(d||(d={}));var M=T("todolists/addTodolist",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.rejectWithValue,e.next=3,L(t.title);case 3:if((r=e.sent).data.resultCode!==l.succeeded){e.next=8;break}return e.abrupt("return",{todolist:r.data.data.item});case 8:return e.abrupt("return",n({value:r.data,showError:!1}));case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),z=T("todolists/removeTodolist",function(){var e=Object(C.a)(w.a.mark((function e(t,a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,a.dispatch)(q({id:t.todolistId,entityStatus:s.loading})),e.next=4,W(t.todolistId);case 4:return e.sent,e.abrupt("return",{todolistId:t.todolistId});case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),D=T("todolists/fetchTodolists",function(){var e=Object(C.a)(w.a.mark((function e(t){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return a=e.sent,e.abrupt("return",{todolists:a.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),P=T("todolists/changeTodolistTitle",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.rejectWithValue,e.next=3,F(t.todolistId,t.title);case 3:if(r=e.sent,console.log(r),r.data.resultCode!==l.succeeded){e.next=9;break}return e.abrupt("return",{todolistId:t.todolistId,title:t.title});case 9:return e.abrupt("return",n({value:r.data,showError:!0}));case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),R=Object(O.d)({name:"todolists",initialState:[],reducers:{changeTodolistFilterAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));-1!==a&&(e[a].filter=t.payload.filter)},changeTodolistEntityStatusAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));-1!==a&&(e[a].entityStatus=t.payload.entityStatus)}},extraReducers:function(e){e.addCase(P.fulfilled,(function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.todolistId}));-1!==a&&(e[a].title=t.payload.title)})).addCase(M.fulfilled,(function(e,t){e.unshift(Object(I.a)(Object(I.a)({},t.payload.todolist),{},{filter:d.all,entityStatus:s.idle}))})).addCase(z.fulfilled,(function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.todolistId}));-1!==a&&e.splice(a,1)})).addCase(D.fulfilled,(function(e,t){return t.payload.todolists.map((function(e){return Object(I.a)(Object(I.a)({},e),{},{filter:d.all,entityStatus:s.idle})}))})).addCase(x,(function(){return[]}))}}),V=R.reducer,N=R.actions,q=(N.changeTodolistFilterAC,N.changeTodolistEntityStatusAC),_={fetchTodolists:D,removeTodolist:z,addTodolist:M,changeTodolistTitle:P},B=a(161),H=a(121),U=a(31),Z=a(171),J=a(158),K=Object(n.memo)((function(e){var t=e.disabled,a=void 0!==t&&t,o=e.addItem,i=Object(n.useState)(""),l=Object(U.a)(i,2),s=l[0],c=l[1],u=Object(n.useState)(null),d=Object(U.a)(u,2),f=d[0],p=d[1],m=function(){""!==s.trim()?o(s).then((function(){c("")})).catch((function(e){e.message||e.showError||p(e.value.messages[0])})):p("Title is required")};return r.a.createElement("div",null,r.a.createElement(Z.a,{variant:"outlined",disabled:a,error:!!f,value:s,onChange:function(e){c(e.currentTarget.value),p(null)},onKeyPress:function(e){null!==f?p(null):13===e.charCode&&m()},label:"Title",helperText:f}),r.a.createElement(h.a,{color:"primary",onClick:m,disabled:a},r.a.createElement(J.a,null)))})),$=function(e){return A.get("todo-lists/".concat(e,"/tasks"))},Y=function(e,t){return A.delete("todo-lists/".concat(e,"/tasks/").concat(t))},G=function(e,t){return A.post("todo-lists/".concat(e,"/tasks"),{title:t})},Q=function(e,t,a){return A.put("todo-lists/".concat(e,"/tasks/").concat(t),a)},X=T("tasks/fetchTasks",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(t.todolistId);case 2:return n=e.sent,r=n.data.items,e.abrupt("return",{tasks:r,todolistId:t.todolistId});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),ee=T("tasks/removeTask",function(){var e=Object(C.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(t.todolistId,t.taskId);case 2:return e.sent,e.abrupt("return",{todolistId:t.todolistId,taskId:t.taskId});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),te=T("tasks/addTask",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.rejectWithValue,e.next=3,G(t.todolistId,t.title);case 3:if((r=e.sent).data.resultCode!==l.succeeded){e.next=9;break}return o=r.data.data.item,e.abrupt("return",{task:o});case 9:return e.abrupt("return",n({value:r.data,showError:!1}));case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),ae=T("tasks/updateTask",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r,o,i,s,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.getState,a.dispatch,r=a.rejectWithValue,o=n(),i=o.tasks[t.todolistId].find((function(e){return e.id===t.taskId}))){e.next=6;break}return console.log("The task was not found in the state"),e.abrupt("return",r({value:null,showError:!0}));case 6:return s=Object(I.a)({deadline:i.deadline,description:i.description,priority:i.priority,startDate:i.startDate,title:i.title,status:i.status},t.model),e.next=9,Q(t.todolistId,t.taskId,s);case 9:if((c=e.sent).data.resultCode!==l.succeeded){e.next=14;break}return e.abrupt("return",t);case 14:return e.abrupt("return",r({value:c.data,showError:!0}));case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),ne=Object(O.d)({name:"tasks",initialState:{},reducers:{},extraReducers:function(e){e.addCase(ae.fulfilled,(function(e,t){var a=e[t.payload.todolistId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));-1!==n&&(a[n]=Object(I.a)(Object(I.a)({},a[n]),t.payload.model))})).addCase(te.fulfilled,(function(e,t){e[t.payload.task.todoListId].unshift(t.payload.task)})).addCase(ee.fulfilled,(function(e,t){var a=e[t.payload.todolistId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));-1!==n&&a.splice(n,1)})).addCase(X.fulfilled,(function(e,t){e[t.payload.todolistId]=t.payload.tasks})).addCase(x,(function(){return{}})).addCase(_.addTodolist.fulfilled,(function(e,t){e[t.payload.todolist.id]=[]})).addCase(_.removeTodolist.fulfilled,(function(e,t){delete e[t.payload.todolistId]})).addCase(_.fetchTodolists.fulfilled,(function(e,t){t.payload.todolists.forEach((function(t){e[t.id]=[]}))}))}}).reducer,re={fetchTasks:X,removeTask:ee,addTask:te,updateTask:ae},oe=a(32),ie=function(e){var t=Object(y.b)();return Object(n.useMemo)((function(){return Object(oe.b)(e,t)}),[])},le=Object(n.memo)((function(e){var t=e.todolist,a=ie(R.actions).changeTodolistFilterAC,n=function(e){a({id:t.id,filter:e})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{variant:"all"===t.filter?"outlined":"text",onClick:function(){return n(d.all)},color:"default"},"All"),r.a.createElement(v.a,{variant:"active"===t.filter?"outlined":"text",onClick:function(){return n(d.active)},color:"primary"},"Active"),r.a.createElement(v.a,{variant:"completed"===t.filter?"outlined":"text",onClick:function(){return n(d.completed)},color:"secondary"},"Completed"))})),se=a(173),ce=Object(n.memo)((function(e){var t=e.value,a=e.onChange;console.log("EditableSpan called");var o=Object(n.useState)(!1),i=Object(U.a)(o,2),l=i[0],s=i[1],c=Object(n.useState)(t),u=Object(U.a)(c,2),d=u[0],f=u[1];return l?r.a.createElement(Z.a,{value:d,onChange:function(e){f(e.currentTarget.value)},autoFocus:!0,onBlur:function(){s(!1),a(d)}}):r.a.createElement("span",{onDoubleClick:function(){s(!0),f(t)}},t)})),ue=a(160),de=a(84),fe=a.n(de),pe=Object(n.memo)((function(e){var t=e.task;console.log("task");var a=ie(re),n=a.removeTask,o=a.updateTask;return r.a.createElement("div",{key:t.id,className:t.status===c.Completed?fe.a.isDone:""},r.a.createElement(se.a,{checked:t.status===c.Completed,color:"primary",onChange:function(e){o({taskId:t.id,todolistId:t.todoListId,model:{status:e.currentTarget.checked?c.Completed:c.New}})}}),r.a.createElement(ce,{value:t.title,onChange:function(e){return o({taskId:t.id,todolistId:t.todoListId,model:{title:e}})}}),r.a.createElement(h.a,{onClick:function(){return n({taskId:t.id,todolistId:t.todoListId})}},r.a.createElement(ue.a,null)))})),me=function(e){return e.tasks},he=Object(n.memo)((function(e){var t,a=e.todolist,n=Object(y.c)(me),o=n[a.id];return"active"===a.filter&&(o=n[a.id].filter((function(e){return e.status===c.New}))),"completed"===a.filter&&(o=n[a.id].filter((function(e){return e.status===c.Completed}))),r.a.createElement(r.a.Fragment,null,null===(t=o)||void 0===t?void 0:t.map((function(e){return r.a.createElement(pe,{key:e.id,task:e})})))})),be=function(e){var t=e.todolist,a=ie(_),n=a.removeTodolist,o=a.changeTodolistTitle;return r.a.createElement("h3",null,r.a.createElement(ce,{value:t.title,onChange:function(e){return o({todolistId:t.id,title:e})}}),r.a.createElement(h.a,{onClick:function(){return n({todolistId:t.id})},disabled:"loading"===t.entityStatus},r.a.createElement(ue.a,null)))},ve=Object(n.memo)((function(e){var t=e.demo,a=void 0!==t&&t,o=e.todolist;console.log("Todolist called");var i=ie(re),l=i.fetchTasks,s=i.addTask;Object(n.useEffect)((function(){a||l({todolistId:o.id})}),[]);return r.a.createElement("div",null,r.a.createElement(be,{todolist:o}),r.a.createElement(K,{addItem:function(e){return s({title:e,todolistId:o.id}).unwrap()},disabled:"loading"===o.entityStatus}),r.a.createElement(he,{todolist:o}),r.a.createElement("div",{style:{paddingTop:"10px"}},r.a.createElement(le,{todolist:o})))})),ge=a(15),Ee=function(e){return e.todolists},ke=function(e){return e.auth.isLoggedIn},ye=function(e){var t=e.demo,a=void 0!==t&&t,o=Object(y.c)(Ee),i=Object(y.c)(ke),l=ie(_),s=l.fetchTodolists,c=l.addTodolist;Object(n.useEffect)((function(){!a&&i&&s()}),[]);return i?r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{container:!0,style:{justifyContent:"center",padding:"30px"}},r.a.createElement(K,{addItem:function(e){return c({title:e}).unwrap()}})),r.a.createElement(B.a,{container:!0,spacing:3,style:{justifyContent:"center"}},o.map((function(e){return r.a.createElement(B.a,{item:!0,key:e.id},r.a.createElement(H.a,{style:{padding:"10px"}},r.a.createElement(ve,{todolist:e,demo:a})))})))):r.a.createElement(ge.a,{to:"/login"})},Ie=a(175),je=a(172),we={status:s.idle,error:null,isInitialized:!1},Ce=Object(O.d)({name:"app",initialState:we,reducers:{setAppStatusAC:function(e,t){e.status=t.payload.status},setAppErrorAC:function(e,t){e.error=t.payload.error},setInitializedAC:function(e,t){e.isInitialized=t.payload.isInitialized}},extraReducers:function(e){e.addMatcher((function(e){return e.type.endsWith("/pending")}),(function(e){e.status=s.loading})).addMatcher((function(e){return e.type.endsWith("/rejected")}),(function(e,t){t.payload?t.payload.showError&&(e.error=t.payload.value?t.payload.value.messages[0]:"Some error occurred"):e.error=t.error?t.error.message:"Some error occurred",e.status=s.failed})).addMatcher((function(e){return e.type.endsWith("/fulfilled")}),(function(e){e.status=s.idle})).addMatcher((function(e){return e.type.includes("auth/initializeApp")&&("fulfilled"===e.meta.requestStatus||"rejected"===e.meta.requestStatus)}),(function(e){e.isInitialized=!0}))}}),Oe=Ce.reducer,xe=Ce.actions,Te=(xe.setAppErrorAC,xe.setAppStatusAC,function(e){return e.app.error}),Ae=function(e){return e.app.isInitialized},Se=function(e){return e.app.status};function Le(e){return r.a.createElement(je.a,Object.assign({elevation:6,variant:"filled"},e))}function We(){var e=Object(y.c)(Te),t=ie(Ce.actions).setAppErrorAC,a=function(e,a){"clickaway"!==a&&t({error:null})},n=null!==e;return r.a.createElement(Ie.a,{open:n,autoHideDuration:6e3,onClose:a},r.a.createElement(Le,{onClose:a,severity:"error"},e))}var Fe=a(58),Me=a(176),ze=a(156),De=a(162),Pe=a(163),Re=a(89),Ve=function(e){return A.post("auth/login",e)},Ne=function(){return A.delete("auth/login")},qe=function(){return A.get("auth/me")},_e=T("auth/initializeApp",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.rejectWithValue,a.dispatch,e.next=3,qe();case 3:if(e.sent.data.resultCode!==l.succeeded){e.next=6;break}return e.abrupt("return",{isLoggedIn:!0});case 6:return e.abrupt("return",n({value:null,showError:!1}));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Be=T("auth/login",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.rejectWithValue,e.next=3,Ve(t);case 3:if((r=e.sent).data.resultCode!==l.succeeded){e.next=8;break}return e.abrupt("return",{isLoggedIn:!0});case 8:return e.abrupt("return",n(r.data));case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),He=T("auth/logout",function(){var e=Object(C.a)(w.a.mark((function e(t,a){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.dispatch,r=a.rejectWithValue,e.next=3,Ne();case 3:if(e.sent.data.resultCode!==l.succeeded){e.next=9;break}return n(x()),e.abrupt("return",{isLoggedIn:!1});case 9:return e.abrupt("return",r(null));case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Ue=Object(O.d)({name:"auth",initialState:{isLoggedIn:!1},reducers:{},extraReducers:function(e){e.addCase(_e.fulfilled,(function(e,t){e.isLoggedIn=t.payload.isLoggedIn})).addCase(Be.fulfilled,(function(e,t){e.isLoggedIn=t.payload.isLoggedIn})).addCase(He.fulfilled,(function(e,t){e.isLoggedIn=t.payload.isLoggedIn}))}}).reducer,Ze={initializeApp:_e,login:Be,logout:He},Je=function(){var e=Object(y.c)(ke),t=ie(Ze).login,a=ie(Ce.actions).setAppErrorAC,n=Object(Re.a)({validate:function(e){var t={};return e.password?e.password.length<6&&(t.password="Must be 6 characters or more"):t.password="Required",e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",t},initialValues:{email:"",password:"",rememberMe:!1},onSubmit:function(e,n){t(e).unwrap().catch((function(e){var t=e.fieldsErrors;e.message||(e.fieldsErrors.length?t.forEach((function(e){n.setFieldError(e.field,e.error)})):a({error:e.messages[0]}))}))}});return e?r.a.createElement(ge.a,{to:"/"}):r.a.createElement(B.a,{container:!0,justify:"center"},r.a.createElement(B.a,{item:!0,xs:4},r.a.createElement("form",{onSubmit:n.handleSubmit},r.a.createElement(Me.a,null,r.a.createElement(ze.a,null,r.a.createElement("p",null,"To log in get registered ",r.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"},"here")),r.a.createElement("p",null,"or use common test account credentials:"),r.a.createElement("p",null," Email: free@samuraijs.com"),r.a.createElement("p",null,"Password: free")),r.a.createElement(De.a,null,r.a.createElement(Z.a,Object.assign({label:"Email",margin:"normal"},n.getFieldProps("email"))),n.touched.email&&n.errors.email?r.a.createElement("div",{style:{color:"red"}},n.errors.email):null,r.a.createElement(Z.a,Object.assign({type:"password",label:"Password",margin:"normal"},n.getFieldProps("password"))),n.touched.password&&n.errors.password?r.a.createElement("div",{style:{color:"red"}},n.errors.password):null,r.a.createElement(Pe.a,{label:"Remember me",control:r.a.createElement(se.a,Object.assign({},n.getFieldProps("rememberMe"),{checked:n.values.rememberMe}))}),r.a.createElement(v.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))},Ke=function(e){var t=e.demo,a=void 0!==t&&t,o=Object(y.c)(Se),i=Object(y.c)(Ae),l=Object(y.c)(ke),s=ie(Ze),c=s.initializeApp,u=s.logout;Object(n.useEffect)((function(){c()}),[]);return i?r.a.createElement(Fe.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(We,null),r.a.createElement(p.a,{position:"static"},r.a.createElement(m.a,null,r.a.createElement(h.a,{edge:"start",color:"inherit","aria-label":"menu"},r.a.createElement(k.a,null)),r.a.createElement(b.a,{variant:"h6"},"News"),l&&r.a.createElement(v.a,{color:"inherit",onClick:function(){return u()}},"Log out")),"loading"===o&&r.a.createElement(g.a,null)),r.a.createElement(E.a,{fixed:!0},r.a.createElement(ge.b,{exact:!0,path:"/",render:function(){return r.a.createElement(ye,{demo:a})}}),r.a.createElement(ge.b,{path:"/login",render:function(){return r.a.createElement(Je,null)}})))):r.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},r.a.createElement(f.a,null))},$e=a(87),Ye=Object($e.a)({tasks:ne,todolists:V,app:Oe,auth:Ue}),Ge=Object(O.a)({reducer:Ye});window.store=Ge,i.a.render(r.a.createElement(y.a,{store:Ge},r.a.createElement(Ke,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},84:function(e,t,a){e.exports={isDone:"task_isDone__3kL2m"}}},[[101,1,2]]]);
//# sourceMappingURL=main.cf76b087.chunk.js.map